# OWASP CRS 4.22.0 - Exclusion Rules After CRS
# This file is loaded AFTER all CRS rules, so SecRuleUpdateTargetById works correctly

# Ce qui fonctionne correctement (pas de faux positifs)
# ✓ Recherche légitime (search=chocolate+cake)
# ✓ Cookie de session (session_id=abc123def456)
# ✓ Paramètre vide (?param=)
# ✓ SQLi reste bloqué (sécurité OK)
# ✓ XSS reste bloqué (sécurité OK)

# ============================================================== #
# FALSE POSITIVES EXCLUSIONS                                     #
# ============================================================== #
# Add exclusions here ONLY after testing and identifying real false positives
# Follow methodology in: waf_rule/methodologie_faux_positifs.md

# Example format:
# SecRuleUpdateTargetById 942100 "!ARGS:search"  # Reason: legitimate search with SQL keywords


## Faux Positifs Detecte :

# 1. HTML dans title (simple)
# Test : title=My <b>Amazing</b> Recipe
# Résultat actuel : HTTP 403 (bloqué)
# Attendu : HTTP 404 (autorisé)
# Cause probable :
#  => Règles OWASP CRS détectent <b> comme XSS
# Règle d'exclusion à créer :
#  => Autoriser balises HTML sûres (<b>, <i>, <strong>, <em>) dans le champ title

# 2. HTML dans description
# Test : description=<p>This is a great recipe</p>
# Résultat actuel : HTTP 403 (bloqué)
# Attendu : HTTP 404 (autorisé)
# Cause probable : 
#  => Règles OWASP CRS détectent <p> comme XSS
# Règle d'exclusion à créer :
#  => Autoriser balises HTML sûres (<p>, <br>, <ul>, <li>) dans le champ description

# 3. Titre avec balises HTML multiples
# Test : title=Quick <i>Recipe</i> in <b>30min</b>
# Résultat actuel : HTTP 403 (bloqué)
# Attendu : HTTP 404 (autorisé)
# Cause probable :
#  => Combinaison de plusieurs balises HTML (<i> + <b>)
# Règle d'exclusion à créer :
#  => Même exclusion que #1, mais tester avec plusieurs balises
